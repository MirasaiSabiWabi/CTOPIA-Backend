<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pop Cat Click Counter</title>
<style>
  body {
    background: url('https://i.pinimg.com/originals/f7/4c/e6/f74ce6007b53858d32503641f6dd88ba.jpg') no-repeat center center fixed;
    background-size: cover;
    overflow: hidden;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: Arial, sans-serif;
    color: #fff;
  }

  #counter {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    font-size: 48px;
    font-weight: bold;
    text-transform: uppercase;
    text-align: center;
    text-shadow: 2px 2px 4px #000;
  }

  #message {
    position: absolute;
    top: 60%;
    font-size: 16px;
    text-align: center;
    color: #fff;
    text-shadow: 1px 1px 2px #000;
  }

  #message a {
    color: #fff;
    text-decoration: underline;
  }

  #popcat {
    position: fixed;
    bottom: 20px;
    cursor: pointer;
    transition: transform 0.3s ease;
  }

  .pop {
    transform: scale(1.5);
  }

  .floating-text {
    position: absolute;
    font-size: 24px;
    font-weight: bold;
    animation: float 1s ease-out forwards;
  }

  @keyframes float {
    0% {
      opacity: 1;
      transform: translateY(0);
    }
    100% {
      opacity: 0;
      transform: translateY(-50px);
    }
  }

  #countryList {
    position: fixed;
    top: 20px;
    right: 20px;
    background: rgba(0, 0, 0, 0.5);
    padding: 10px;
    border-radius: 8px;
    max-height: 50vh;
    overflow-y: auto;
  }

  .country-item {
    opacity: 0;
    animation: fadeIn 1s forwards;
  }

  @keyframes fadeIn {
    to {
      opacity: 1;
    }
  }
</style>
</head>
<body>

<div id="counter">Click count: 0</div>
<div id="message">
  Why are you visiting CloneTopia Back-end? Well you're sus.. <a href="https://discord.gg/47ny2ybhRk" target="_blank">join the discord here</a>
</div>
<img id="popcat" src="https://img.itch.zone/aW1nLzQ3NDY4MjYucG5n/original/sDIDCt.png" alt="Pop Cat" width="200">

<div id="countryList"></div>

<audio id="popSound" src="https://ctop-back.vercel.app/audios/pop.mp3"></audio>
<audio id="themeSound" src="https://ctop-back.vercel.app/audios/theme.mp3" autoplay loop></audio>

<script>
  var popcat = document.getElementById('popcat');
  var counter = document.getElementById('counter');
  var countryList = document.getElementById('countryList');
  var popSound = document.getElementById('popSound');
  var themeSound = document.getElementById('themeSound');
  themeSound.volume = 0.5;
  popSound.volume = 1.0;

  var clickCount = localStorage.getItem('clickCount') ? parseInt(localStorage.getItem('clickCount')) : 0;
  var countries = JSON.parse(localStorage.getItem('countries')) || {};

  function updateCounter() {
    counter.textContent = 'Click count: ' + clickCount;
    localStorage.setItem('clickCount', clickCount);
  }

  function updateCountryList() {
    countryList.innerHTML = '';
    for (const [country, count] of Object.entries(countries)) {
      const countryItem = document.createElement('div');
      countryItem.textContent = `${country}: ${count}`;
      countryItem.className = 'country-item';
      countryList.appendChild(countryItem);
    }
    localStorage.setItem('countries', JSON.stringify(countries));
  }

  function showFloatingText() {
    var floatingText = document.createElement('div');
    floatingText.textContent = '+1';
    floatingText.className = 'floating-text';
    document.body.appendChild(floatingText);

    setTimeout(function() {
      floatingText.remove();
    }, 1000);
  }

  function popEffect() {
    popcat.src = 'https://cdn.wikiwiki.jp/to/w/evade_/Popcat/::ref/Png_29.webp?rev=ebb76899c17c9a9e9a753276a0228059&t=20230327160042.png';
    popcat.classList.add('pop');
    setTimeout(function() {
      popcat.src = 'https://img.itch.zone/aW1nLzQ3NDY4MjYucG5n/original/sDIDCt.png';
      popcat.classList.remove('pop');
    }, 1500);
  }

  function getCountryEmoji(countryCode) {
    return countryCode.toUpperCase().replace(/./g, char => 
      String.fromCodePoint(127397 + char.charCodeAt())
    );
  }

  function addCountryClick(country) {
    if (countries[country]) {
      countries[country]++;
    } else {
      countries[country] = 1;
    }
    updateCountryList();
  }

  async function fetchCountry() {
    try {
      const response = await fetch('https://ipapi.co/json/');
      const data = await response.json();
      const countryCode = data.country_code || 'XX';
      const countryEmoji = getCountryEmoji(countryCode);
      addCountryClick(countryEmoji);
    } catch (error) {
      console.error('Error fetching country:', error);
    }
  }

  setInterval(fetchCountry, 2000);

  popcat.addEventListener('click', function() {
    clickCount++;
    updateCounter();
    showFloatingText();
    popEffect();
    popSound.play();
    fetchCountry();
  });

  updateCounter();
  updateCountryList();
</script>

</body>
</html>
